package test.liuzehua.fastdfsdemo.headler;import org.springframework.mock.web.MockMultipartFile;import org.springframework.web.multipart.MultipartFile;import test.liuzehua.fastdfsdemo.client.FastDFSClient;import test.liuzehua.fastdfsdemo.model.FastDFSFile;import java.io.*;/** * @author liuzehua * 2020/7/11 **/public class FDFSTest {    public static void main(String[] args) throws Exception {//        File file = new File("D:/hello.jpg");//        MultipartFile mulFile = new MockMultipartFile(//                "hello.jpg", //文件名//                "hello.jpg", //originalName 相当于上传文件在客户机上的文件名//                "application/octet-stream",//                new FileInputStream(file) //文件流//        );//        String s = saveFile(mulFile);//        System.out.println(s);        FastDFSClient.deleteFile("group1","M00/00/00/wKhRpl8JiJ-AUVLXAAAAHBDfNP056_big.text");//        downFile();    }    public static void  downFile() throws IOException {        InputStream inputStream = FastDFSClient.downFile("group1", "M00/00/00/wKhRpl8JiJ-AUVLXAAAAHBDfNP056.text");        byte[] buffer = new byte[inputStream.available()];        inputStream.read(buffer);        inputStream.close();        // 清空response        OutputStream toClient = new FileOutputStream(new File("D:/test.text"));        toClient.write(buffer);        toClient.flush();        toClient.close();    }    public static String saveFile(MultipartFile multipartFile) throws IOException {        String[] fileAbsolutePath={};        String fileName=multipartFile.getOriginalFilename();        String ext = fileName.substring(fileName.lastIndexOf(".") + 1);        byte[] file_buff = null;        InputStream inputStream=multipartFile.getInputStream();        if(inputStream!=null){            int len1 = inputStream.available();            file_buff = new byte[len1];            inputStream.read(file_buff);        }        inputStream.close();        FastDFSFile file = new FastDFSFile(fileName, file_buff, ext);        try {            fileAbsolutePath = FastDFSClient.upload(file);  //upload to fastdfs        } catch (Exception e) {            System.out.println("upload file Exception!");        }        if (fileAbsolutePath==null) {            System.out.println("upload file failed,please upload again!");        }        String path= FastDFSClient.getTrackerUrl()+fileAbsolutePath[0]+ "/"+fileAbsolutePath[1];        return path;    }}